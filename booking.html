<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Book Your Trip</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background: #008cba;
            color: white;
            padding: 20px;
            text-align: center;
        }
        nav a {
            margin: 0 15px;
            text-decoration: none;
            color: white;
        }
        nav a.active {
            font-weight: bold;
            color: #ff9900;
        }
        form {
            max-width: 500px;
            margin: auto;
            margin-top: 20px;
            background: #f4f4f4;
            padding: 20px;
            border-radius: 8px;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input,
        select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }
        button {
            margin-top: 15px;
            background: #008cba;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        #totalPrice {
            margin-top: 15px;
            font-weight: bold;
        }

        .error {
            color: red;
            font-size: 13px;
        }
    </style>
</head>

<body>
    <header>
        <h1>Booking Form</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="packages.html">Packages</a>
            <a href="booking.html" class="active">Booking</a>
            <a href="gallery.html">Gallery</a>
            <a href="about.html">About Us</a>
        </nav>
    </header>
    <form id="bookingForm" autocomplete="off">
        <label for="name">Full Name</label>
        <input type="text" id="name" name="name" required>

        <label for="checkIn">Check-in Date</label>
        <input type="date" id="checkIn" name="checkIn" required>
        <label for="checkOut">Check-out Date</label>
        <input type="date" id="checkOut" name="checkOut" required>

        <label for="guests">Guests</label>
        <input type="number" id="guests" name="guests" min="1" value="2" required>

        <label for="package">Select Package</label>
        <select id="package" name="package" required></select>

        <label for="promo">Promo Code</label>
        <input type="text" id="promo" name="promo">

        <div id="totalPrice">Total: ₹0</div>
        <div class="error" id="formError"></div>
        <button type="submit" id="submitBtn" disabled>Book Now</button>
    </form>
    <script>
        const packages = [
            { id: 1, name: "Beach Paradise", basePrice: 105000, durationDays: 5, season: "low" },
            { id: 2, name: "Adventure Trek", basePrice: 119500, durationDays: 14, season: "high" },
            { id: 3, name: "European Delight", basePrice: 154000, durationDays: 10, season: "mid" },
            { id: 4, name: "Most Wanted Bhutan", basePrice: 85000, durationDays: 7, season: "mid" }
        ];

        const packageSelect = document.getElementById('package');
        packages.forEach(pkg => {
            const opt = document.createElement('option');
            opt.value = pkg.id;
            opt.textContent = `${pkg.name} (${pkg.durationDays} days)`;
            packageSelect.appendChild(opt);
        });

        function getSeasonMultiplier(season) {
            switch (season) {
                case "high": return 1.3;
                case "mid": return 1.15;
                default: return 1.0;
            }
        }

        function calculateTotal(basePrice, durationDays, nights, guests, season, promo) {
            const perPersonPerDay = basePrice / durationDays / 2;
            let price = perPersonPerDay * nights * guests * getSeasonMultiplier(season);

            let promoMult = 1.0;
            switch (promo.trim().toUpperCase()) {
                case "EARLYBIRD":
                    promoMult = 0.9;
                    break;
                default:
                    promoMult = 1.0;
            }
            price *= promoMult;

            return Math.round(price);
        }

        function updateTotal() {
            const checkIn = document.getElementById('checkIn').value;
            const checkOut = document.getElementById('checkOut').value;
            const guests = parseInt(document.getElementById('guests').value) || 2;
            const pkgId = parseInt(packageSelect.value);
            const promo = document.getElementById('promo').value;
            let errorMsg = "";
            let total = 0;
            let nights = 0;
            let pkgName = '';

            if (!checkIn || !checkOut || isNaN(guests) || guests < 1 || isNaN(pkgId)) {
                errorMsg = "Please fill all required fields.";
            } else {
                const inDate = new Date(checkIn);
                const outDate = new Date(checkOut);
                nights = Math.floor((outDate - inDate) / (1000 * 60 * 60 * 24));
                if (nights < 1) {
                    errorMsg = "Checkout must be at least one day after check-in!";
                }
            }

            if (!errorMsg && pkgId) {
                const selectedPkg = packages.find(pkg => pkg.id === pkgId);
                total = calculateTotal(selectedPkg.basePrice, selectedPkg.durationDays, nights, guests, selectedPkg.season, promo);
                pkgName = selectedPkg.name;
            }

            document.getElementById('totalPrice').textContent = total
                ? `Total: ₹${total} (${nights} nights for ${guests} guests in ${pkgName})`
                : "Total: ₹0";
            document.getElementById('formError').textContent = errorMsg;
            document.getElementById('submitBtn').disabled = !!errorMsg;
            return !errorMsg;
        }
        ['change', 'input'].forEach(evt => {
            document.getElementById('bookingForm').addEventListener(evt, updateTotal, true);
        });
        updateTotal();

        document.getElementById('bookingForm').addEventListener('submit', function (e) {
            e.preventDefault();
            if (updateTotal()) {
                alert("Booking successful!");
                this.reset();
                updateTotal();
            }
        });
    </script>
</body>
</html>